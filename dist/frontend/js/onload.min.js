/*!
 * Digital Sandbox v2.1 (https://github.com/codeworksdev/digital-sandbox)
 * Copyright (c) 2014-2018 CODEWORKS <support@codeworksnyc.com>
 * Licensed under the MIT license
 */
function mochi_init(){'index'==this.__page_name&&/^https:\/\//.test(this.__href)&&this.setOption('ENABLE_SERVICE_WORKER',!1)}function mochi_load_page0(){this.extend('clipboard',MyClipboard),this.extend('master',DigitalSandboxMaster),window.self==window.top?this.extend('wrap',DigitalSandboxWrap):this.extend('apps',DigitalSandboxApps)}function MyClipboard(){}MyClipboard.prototype={_copyFallback:function(m){var p=document.createElement('textarea');p.value=m,document.body.appendChild(p),p.focus(),p.select();try{document.execCommand('copy'),this.onSuccess()}catch(q){this.onError(q)}document.body.removeChild(p)},copy:function(m){navigator.clipboard?navigator.clipboard.writeText(m).then(function(){$m.clipboard.onSuccess()},function(p){$m.clipboard.onError(p)}):this._copyFallback(m)},onError:function(m){alert(m)},onSuccess:function(){}};function DigitalSandboxMaster(){this._options(),this._html(),this._vars()}DigitalSandboxMaster.prototype={_options:function(){this.options=JSON.parse(JSON.stringify(_.defaults(DigitalSandboxOptions,{BODY:'',BROWSER_TAB_AUTO_LABEL:!0,BROWSER_TAB_SUFFIX:'Digital Sandbox',BROWSER_TAB_SUFFIX_DELIMITER:'|',BROWSER_TAB_SUFFIX_ENABLED:!0,LAUNCHER_AUTOGEN_TITLE_VARS:!0,LAUNCHER_ENABLE_FOLDER_SWITCHING:!0,LAUNCHER_ENABLE_TITLE_VAR:!0,LAUNCHER_HTML_HEADER_BODY:'',LAUNCHER_HTML_HEADER_ENABLED:!0,LAUNCHER_HTML_HEADER_H1:'Digital Sandbox',LAUNCHER_HTML_HEADER_H2:'Please make a selection to begin.',LAUNCHER_WIDGET_NAME:'simple',THEME_DEFAULT_DEVICE:'ipad',THEME_DEFAULT_ORIENTATION:'l',THEME_DEFAULT_WALLPAPER_NAME:'desk',THEME_NAME:'default',TOOLBAR_ENABLE_ABOUT:!0,TOOLBAR_ENABLE_COLLAPSE:!0,TOOLBAR_ENABLE_DEVICE:!0,TOOLBAR_ENABLE_EXPAND:!0,TOOLBAR_ENABLE_HOME:!0,TOOLBAR_ENABLE_LAUNCH:!0,TOOLBAR_ENABLE_QREFRESH:!0,TOOLBAR_ENABLE_REFRESH:!0,TOOLBAR_ENABLE_RELOAD:!0,TOOLBAR_ENABLE_ROTATE:!0,TOOLBAR_ENABLE_WALLPAPER:!0,TOOLBAR_ENABLED:!0,TOOLBAR_START_COLLAPSED:!1})))},_html:function(){var m=function(p){$m.__body.prepend(p.join('')),$m.__container=$m.__body.find('#container')};window.self==window.top?m(['<div id="container">','<table>','<tbody>','<tr>','<td class="align-middle">','<div id="content">','<iframe src="about:blank"></iframe>','</div>','</td>','</tr>','</tbody>','</table>','</div>']):(m(['<div id="container" class="container my-4">','<div class="row">','<div class="col-xl">','<div id="header" class="d-none">','<h1 class="display-4"></h1>','<p class="lead"></p>','<hr>','</div>','<div id="apps"></div>','</div>','</div>','</div>']),$m.setView(1)),this.options.THEME_NAME&&/^\w+$/.test(this.options.THEME_NAME)&&function(p){var q=+new Date,w='frontend/themes/'+p.options.THEME_NAME+'/onload.js',x=['frontend/themes/default/css/style.css?_='+q,'frontend/themes/default/css/print.css?_='+q];if($m.__head.append('<link rel="stylesheet" href="'+x[0]+'" media="all"><link rel="stylesheet" href="'+x[1]+'" media="print">'),/^https?:\/\//.test($m.__href))$.getScript(w).fail(function(){console.error('Unable to load theme scripts.')});else{var y=document.createElement('script');y.src=w+'?_='+q,document.getElementsByTagName('body')[0].appendChild(y)}}(this)},_vars:function(){this.ver={date:'2018-08-31',number:'2.1',product:'Digital Sandbox',type:'final'},this.ver.str='<strong>v'+this.ver.number+'-'+this.ver.type+'</strong> '+this.ver.date,this.regex=/^([^\?]+)(?:\?([^\?~\|&]*))?(?:~(([a-z]\w*)(?::([lp]))?))?(?:\|([a-z\d\-]*))?(?:&title=(.*))?$/i,this.iframe=$('iframe'),this.href=decodeURI($m.__href),this.url=this.getMeta(this.href).url},getMeta:function(m){var p={url:{}},q=decodeURI(m||$m.__href);return this.regex.test(q)&&(p.url.dir=RegExp.$1,p.url.query=RegExp.$2,p.url.device=RegExp.$4,p.url.orientation=RegExp.$5,p.url.title=RegExp.$7,p.url.bucket=function(w){return /^[a-z\d]+(\-[a-z\d]+)*$/i.test(w)?w.toLowerCase():''}(RegExp.$6),p.url.base=decodeURI($m.__href).replace(/\/[^\/]*$/,'/'),p.url.external=!!/^https?:\/\//i.test(p.url.query),p.url.src='index.html'+(p.url.bucket?'?'+p.url.bucket:''),p.url.external?p.url.src=p.url.query:/^([\w-\.:]+)(?:\/([\w-\.:]*))?$/.test(p.url.query)&&(p.url.index=RegExp.$2||'index',p.url.app=RegExp.$1.replace(/\:/g,'/'),p.url.ext='html',p.url.src='frontend/apps/'+p.url.app+'/'+p.url.index+'.'+p.url.ext)),p}};function DigitalSandboxWrap(){this._html(),this._toolbar(),this._init()}DigitalSandboxWrap.prototype={_html:function(){$m.master.options.LAUNCHER_ENABLE_TITLE_VAR&&function(m){var p=null;if(_.has(m,'title')&&/\S/.test(m.title))p=m.title;else if(!_.has(m,'app'))/^https?:\/\/([^\/]+)/i.test(m.src)&&$m.master.options.BROWSER_TAB_AUTO_LABEL&&(p=RegExp.$1.toLowerCase());else if($m.master.options.BROWSER_TAB_AUTO_LABEL){var q=/([^\/]+)$/.exec(m.app)[1],w=function(x){return $.trim(window.s.capitalize(x,!0))};/\S/.test(p=_.compact(_.map(q.split(/[^a-z\d]/i),w)).join(' '))&&(p=p.replace(/(\d)\s+(\d)/g,'$1.$2'),p=p.toUpperCase(),p=p.replace(/\sV(\d+)/,' v$1'))}null!==p&&/\S/.test(p)&&($m.master.options.BROWSER_TAB_SUFFIX_ENABLED&&(p+=' '+$.trim($m.master.options.BROWSER_TAB_SUFFIX_DELIMITER||'|')+' ',p+=/\S/.test($m.master.options.BROWSER_TAB_SUFFIX)?$m.master.options.BROWSER_TAB_SUFFIX:$m.master.ver.product),$m.__html.find('title').text(p))}($m.master.url),/^\w+$/.test($m.master.options.THEME_DEFAULT_DEVICE)&&$m.__body.attr('data-device',$m.master.options.THEME_DEFAULT_DEVICE),/^\w+$/.test($m.master.options.THEME_DEFAULT_ORIENTATION)&&$m.__body.attr('data-orientation',$m.master.options.THEME_DEFAULT_ORIENTATION),/^\w+$/.test($m.master.options.THEME_DEFAULT_WALLPAPER_NAME)&&$m.__body.attr('data-wall',$m.master.options.THEME_DEFAULT_WALLPAPER_NAME),function(){var m='DigitalSandboxModalAbout',p=['<div class="modal fade" id="'+m+'" tabindex="-1" role="dialog" aria-labelledby="'+m+'Label" aria-hidden="true">','<div class="modal-dialog modal-dialog-centered" role="document">','<div class="modal-content">','<div class="modal-header">','<h5 class="modal-title" id="'+m+'Label">','<span><strong>'+$m.master.ver.product+' <span class="text-muted">v'+$m.master.ver.number+'</span></strong></span>','</h5>','<button type="button" class="close" data-dismiss="modal" aria-label="Close">','<span aria-hidden="true">&times;</span>','</button>','</div>','<div class="modal-body text-center py-5">','<img src="frontend/img/brand/launcher-icon-4x.png" alt="Logo">','</div>','<div class="modal-footer text-right">','<small class="text-muted">'+$m.master.ver.str+'</small>','<a target="_blank" href="https://github.com/codeworksdev/digital-sandbox" title="GitHub">','<span class="text-info"><i class="fab fa-lg fa-github"></i></span>','</a>','</div>','</div>','</div>','</div>'];$m.__body.append(p.join(''))}()},_toolbar:function(){$m.extend('toolbar',DigitalSandboxToolbar,function(){this.onload()})},_init:function(){if($m.master.url.device){var m='[data-button="'+$m.master.url.device+'"]',p=$m.device.inner.find(m);$m.device.select(p.get(0))}$m.master.url.orientation&&$m.device.rotate($m.master.url.orientation),$m.master.iframe.attr('src',$m.master.url.src)}};function DigitalSandboxToolbar(){this._options(),this._html(),this._vars()}DigitalSandboxToolbar.prototype={_options:function(){this.options={buttons:[{slug:'home',icon:'fas fa-home',label:'Home'},{slug:'refresh',icon:'fas fa-sync-alt',label:'Refresh Parent Window'},{slug:'qrefresh',icon:'fas fa-redo-alt',label:'Refresh Framed Window'},{slug:'reload',icon:'fas fa-bolt',label:'Reload Frame'},{slug:'device',icon:'fas fa-desktop',label:'Device Mode'},{slug:'rotate',icon:'fas fa-arrows-alt-v',label:'Orientation'},{slug:'wallpaper',icon:'fas fa-image',label:'Wallpaper'},{slug:'launch',icon:'fas fa-th-list',label:'Launcher'},{slug:'about',icon:'fas fa-info-circle',label:'About'},{slug:'collapse',icon:'far fa-times-circle',label:'Collapse'},{slug:'expand',icon:'fas fa-angle-left',label:'Expand'}],walls:['default','desk','landscape','bulbs']}},_html:function(){var m=['<div id="toolbar">','<div id="inner-toolbar"></div>','</div>'];$m.master.options.TOOLBAR_ENABLED||(m[0]=m[0].replace(/>$/,' class="d-none">')),$m.master.options.TOOLBAR_START_COLLAPSED&&(m[0]=m[0].replace(/>$/,' data-collapsed="yes">')),$m.__container.prepend(m.join('')),_.each(this.options.buttons,function(p){var q=$('#inner-toolbar'),w=!!$m.master.options['TOOLBAR_ENABLE_'+p.slug.toUpperCase()],x=['<div data-button="'+p.slug+'" title="'+p.label+'">','<i class="fa-fw '+p.icon+'"></i>','</div>'];switch(p.slug){case'expand':w=!!$m.master.options.TOOLBAR_ENABLE_COLLAPSE;}w||(x[0]=x[0].replace(/>$/,' class="d-none">')),q.append(x.join(''))})},_vars:function(){this.container=$('#toolbar'),this.inner=$('#inner-toolbar'),this.buttons=this.inner.find('[data-button]')},do:function(m){var p=_.isElement(m)?$(m):m,q=p.attr('data-button'),w='do'+window.s.capitalize(q);return this[w](p),this},doAbout:function(){$('#DigitalSandboxModalAbout').modal()},doCollapse:function(){this.container.attr('data-collapsed','yes')},doDevice:function(m){$m.device.open(m)},doExpand:function(){this.container.removeAttr('data-collapsed')},doHome:function(){window.location.href=$m.master.url.dir},doLaunch:function(){var p=window.location.href.replace($m.master.regex,'$1?|$6');window.location.href=/\|.+$/.test(p)?p:p.replace(/\?\|$/,'')},doQrefresh:function(){try{$m.master.iframe[0].contentWindow.location.reload()}catch(p){this.doRefresh()}},doRefresh:function(){window.location.reload(!0)},doReload:function(){$m.master.iframe.attr('src',$m.master.iframe.attr('src'))},doRotate:function(){$m.device.rotate()},doWallpaper:function(){$m.toolbar.toggleWallpaper()},onload:function(){return _.each(this.options.buttons,function(m){switch(m.slug){case'device':$m.extend(m.slug,DigitalSandboxDevice,function(){this.onload()});}}),$m.onClick(this.buttons,function(){$m.toolbar.do(this)}),this},toggleWallpaper:function(){var m=$m.__body.attr('data-wall')||'default',p=_.indexOf(this.options.walls,m);return new_w_index=p+1,new_w=this.options.walls[new_w_index<this.options.walls.length?new_w_index:0],$m.__body.attr('data-wall',new_w),this}};function DigitalSandboxDevice(){this._options(),this._html(),this._vars()}DigitalSandboxDevice.prototype={_options:function(){this.options={buttons:{default:'Default',fullscreen:'Full Screen',ipad:'iPad',ipad_mini:'iPad Mini',ipad_air:'iPad Air',ipad_pro_9_7:'iPad Pro 9.7-inch',ipad_pro_12_9:'iPad Pro 12.9-inch',iphone_5s:'iPhone 5',iphone_6plus:'iPhone 6 Plus',galaxy_s5:'Galaxy S5',nexus_7:'Nexus 7',nexus_10:'Nexus 10'},container_id:'device-menu'}},_html:function(){$m.toolbar.buttons.filter('[data-button="device"]').append('<div id="'+this.options.container_id+'"><div id="inner-'+this.options.container_id+'"><span data-action="exit"><i class="fas fa-times-circle"></i></span></div></div>')},_vars:function(){this.def=$m.__body.attr('data-device'),this.container=$('#'+this.options.container_id),this.inner=$('#inner-'+this.options.container_id)},action:function(m){var p=_.isElement(m)?$(m):m,q='action__'+p.attr('data-action');return this[q](p),this},action__exit:function(){return setTimeout('$m.device.close()',50),this},close:function(){return this.container.removeClass('open'),this},onload:function(){return _.each(this.options.buttons,function(m,p){this.inner.append(['<span data-button="'+p+'">','<span title="'+m+'">'+m+'</span>','<span class="float-right">','<span data-option="launch-internal" title="Launch Internal"><i class="fas fa-fw fa-sign-in-alt"></i></span>','<span data-option="launch-external" title="Launch External"><i class="fas fa-fw fa-link"></i></span>','<span data-option="copy-url">','<span data-toggle="popover" data-content="Copied!"><i title="Copy URL" class="far fa-copy"></i></span>','</span>','</span>','</span>'].join('')),p==this.def&&this.inner.find('[data-button="'+p+'"]').addClass('selected')},this),$m.onClick(this.inner.find('[data-action]'),function(){$m.device.action(this)}),$m.onClick(this.inner.find('[data-button] > span:nth-child(1)'),function(){$m.device.select($(this).parent())}),$m.onClick(this.inner.find('[data-button] > span:last-child > span'),{getURLbyDeviceName:function(m){var p=$m.__href,q=null;return q=/\~[a-z][a-z\d_]*/.test(p)?p.replace(/\~[a-z][a-z\d_]*/,'~'+m):/\S/.test($m.master.url.query)?p.replace($m.master.url.query,$m.master.url.query+'~'+m):p+'?~'+m,q}},function(m){var p=$(this),q=p.parents('[data-button]:eq(0)'),w=q.attr('data-button'),x=p.attr('data-option');'copy-url'===x?($m.clipboard.copy(m.data.getURLbyDeviceName(w)),setTimeout(function(){$('.popover[role="tooltip"]').popover('hide')},1500)):'launch-external'===x?window.location.assign(m.data.getURLbyDeviceName(w)):'launch-internal'===x?q.find('> span:nth-child(1)').trigger($m.getOnClickName()):void 0}),$('[data-toggle="popover"]').popover({placement:'left'}),this},open:function(){return this.container.hasClass('open')||this.container.addClass('open'),this},rotate:function(m){var q,w,p='data-orientation';return /^[lp]$/.test(m)?w=m:(q=$m.__body.attr(p),w=q?'l'==q?'p':'l':'l'),$m.__body.attr(p,w),this},select:function(m){var p=_.isElement(m)?$(m):m,q=p.attr('data-button'),w='selected',x=p.hasClass(w);return x||(this.inner.find('[data-button="'+q+'"]').addClass(w),this.inner.find(':not([data-button="'+q+'"])').removeClass(w),$m.__body.attr('data-device',q)),this}};function DigitalSandboxApps(){this._vars(),this._html(),this._init()}DigitalSandboxApps.prototype={_vars:function(){this.bucket=/\?([a-z\d]+(\-[a-z\d]+)*)$/.test(decodeURI($m.__href))?RegExp.$1:'',this.header=$m.__container.find('#header'),this.container=$m.__container.find('#apps'),this.widgetName=this.container.attr('data-widget'),this.cols=this.container.find('[class^="col-"]')},_html:function(){$m.master.options.LAUNCHER_WIDGET_NAME&&/^\w+$/.test($m.master.options.LAUNCHER_WIDGET_NAME)&&(this.container.attr('data-widget',$m.master.options.LAUNCHER_WIDGET_NAME),this.widgetName=$m.master.options.LAUNCHER_WIDGET_NAME),$m.master.options.LAUNCHER_HTML_HEADER_ENABLED&&($m.master.options.LAUNCHER_HTML_HEADER_H1&&/\S/.test($m.master.options.LAUNCHER_HTML_HEADER_H1)&&this.header.find('> h1').html($m.master.options.LAUNCHER_HTML_HEADER_H1),$m.master.options.LAUNCHER_HTML_HEADER_H2&&/\S/.test($m.master.options.LAUNCHER_HTML_HEADER_H2)&&this.header.find('> p.lead').html($m.master.options.LAUNCHER_HTML_HEADER_H2),this.header.removeClass('d-none')),_.has($m.master.options,'LAUNCHER_HTML_HEADER_BODY')&&$m.master.options.LAUNCHER_HTML_HEADER_BODY&&(this.header.find('> p.lead').after($m.master.options.LAUNCHER_HTML_HEADER_BODY),this.cols=this.container.find('[class^="col-"]')),_.has($m.master.options,'BODY')&&$m.master.options.BODY&&(this.container.empty().html($m.master.options.BODY),this.cols=this.container.find('[class^="col-"]')),this.cols.length&&((!this.widgetName||!/^[a-z][a-z\d]*$/.test(this.widgetName))&&this.container.attr('data-widget',this.widgetName='simple'),this['__widget_'+this.widgetName]&&(_.each(this.cols,function(m,p){var q={};q.col=$(m),q.groups=q.col.find('div[data-title]'),q.length=q.groups.length,q.length&&(q.classNames=['ds-widget','ds-widget-'+this.widgetName],q.id=q.classNames[1]+'-'+p,q.col.html('<div class="'+q.classNames.join(' ')+'" id="'+q.id+'">'+this['__widget_'+this.widgetName](q)+'</div>'))},this),$m.onClick(this.cols.find('[data-obj]'),function(m){var p=$(this),q='do__'+p.attr('data-obj');$m.apps[q]&&(m.preventDefault(),$m.apps[q](p))})))},_init:function(){$m.__body.attr('data-ready','yes')},__widget_accordion:function(m){var p=0,q=[];do q.push(function(w,x,y,z){for(var D,E,F,A=0,B=x.length,C=[];A<B;)D=x.eq(A++),E=D.attr('data-title'),F=$m.sanitizeTitle(E),w.bucket&&F!=w.bucket||C.push('<div class="card bg-light" data-bucket="'+F+'"><div class="card-header" id="'+y+'-heading'+z+'"><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#'+y+'-collapse'+z+'" aria-expanded="false" aria-controls="'+y+'-collapse'+z+'">'+E+'</button></h5><a data-enabled="'+($m.master.options.LAUNCHER_ENABLE_FOLDER_SWITCHING?'yes':'no')+'" data-obj="folder" data-action="'+($m.master.url.query?'close':'open')+'" title="'+($m.master.url.query?'Close':'Open')+' Folder" href="'+$m.master.url.dir+($m.master.url.query?'':'?|'+F)+'" target="_top"><i class="fas fa-folder-open"></i><i class="fas fa-folder"></i></a></div><div id="'+y+'-collapse'+z+'" class="collapse" aria-labelledby="'+y+'-heading'+z+'" data-parent="#'+y+'"><div class="card-body">'+w.getHTML_table(D)+'</div></div></div>');return C.join('')}(this,m.groups.eq(p),m.id,p));while(++p<m.length);return q.join('')},__widget_simple:function(m){var p=0,q=[];do q.push(function(w,x){for(var D,E,F,A=0,B=x.length,C=[];A<B;)D=x.eq(A++),E=D.attr('data-title'),F=$m.sanitizeTitle(E),w.bucket&&F!=w.bucket||C.push('<div data-bucket="'+F+'"><h1>'+E+'</h1><a data-enabled="'+($m.master.options.LAUNCHER_ENABLE_FOLDER_SWITCHING?'yes':'no')+'" data-obj="folder" data-action="'+($m.master.url.query?'close':'open')+'" title="'+($m.master.url.query?'Close':'Open')+' Folder" href="'+$m.master.url.dir+($m.master.url.query?'':'?|'+F)+'" target="_top"><i class="fas fa-folder-open"></i><i class="fas fa-folder"></i></a>'+w.getHTML_table(D)+'</div>');return C.join('')}(this,m.groups.eq(p),m.id,p));while(++p<m.length);return q.join('')},getHTML_table:function(m,p){var q=1<arguments.length?p:'table-sm table-bordered table-hover',w='<table class="table'+(/\w/.test(q)?' '+q:'')+'"><tbody>',y=_.map(m.find('a[href]'),function(z){var A=$(z),B=$.trim(A.html().replace(/\s*<\w+[^>]*>([^<]*)<\/\w+>\s*/g,' ($1) ').replace(/\W\)/g,')')),C=this.getMetaByURL.call(this.instance,A.attr('href'),B),D=['<td>','<a target="'+(C.internal?'_top':'_blank')+'" title="'+A.text()+'" href="'+(C.internal||C.external)+'">',A.html(),'</a>','</td>','<td title="Launch Internal">',C.internal?'<a target="_top" href="'+C.internal+'">':'<span class="text-muted">','<i class="fas fa-sign-in-alt"></i>',C.internal?'</a>':'</span>','</td>','<td title="Launch External">',C.external?'<a target="_blank" href="'+C.external+'">':'<span class="text-muted">','<i class="fas fa-link"></i>',C.external?'</a>':'</span>','</td>'];return'<tr>'+D.join('')+'</tr>'},{instance:this,getMetaByURL:function(z,A){var B={external:null,internal:null,meta:null};return /^\.\/\?(.+)$/.test(z)?(B.internal='./index.html?'+RegExp.$1,B.meta=$m.master.getMeta(B.internal).url,B.external=_.size(B.meta)?/^https?:\/{2}/i.test(B.meta.src)?B.meta.src:B.meta.base+B.meta.src:null,this.bucket&&!/\|.*$/.test(B.internal)&&(B.internal+='|'+this.bucket),$m.master.options.LAUNCHER_ENABLE_TITLE_VAR&&$m.master.options.LAUNCHER_AUTOGEN_TITLE_VARS&&!/&title=.*$/.test(B.internal)&&(B.internal+='&title='+encodeURIComponent(A))):B.external=z,B}});return w+y.join('')+'</tbody></table>'}};
