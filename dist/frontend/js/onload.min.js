function mochi_init(){"index"==this.__page_name&&/^https:\/\//.test(this.__href)&&this.setOption("ENABLE_SERVICE_WORKER",!1)}function mochi_load(){this.extend("master",DigitalSandboxMaster)}function mochi_load_view0(){this.extend("wrap",DigitalSandboxWrap)}function mochi_load_view1(){this.extend("apps",DigitalSandboxApps)}function DigitalSandboxMaster(){this._vars()}function DigitalSandboxWrap(){this._html(),this._toolbar(),this._init()}function DigitalSandboxToolbar(){this._options(),this._html(),this._vars()}function DigitalSandboxDevice(){this._options(),this._html(),this._vars()}function DigitalSandboxApps(){this._vars(),this._init()}DigitalSandboxMaster.prototype={_vars:function(){this.ver={date:"2018-08-01",number:"2.0.2",product:"Digital Sandbox",type:"stable"},this.ver.str="v"+this.ver.number+"-"+this.ver.date.replace(/\D/g,"")+"-"+this.ver.type,this.regex=/^([^\?]+)(?:\?([^\?~\|]*))?(?:~(([a-z]\w*)(?::([lp]))?))?(?:\|([a-z\d\-]*))?$/i,this.iframe=$("iframe"),this.href=decodeURI($m.__href),this.url=this.getMeta(this.href).url},getMeta:function(t){var e,a={url:{}},i=decodeURI(t||$m.__href);return this.regex.test(i)&&(a.url.dir=RegExp.$1,a.url.query=RegExp.$2,a.url.device=RegExp.$4,a.url.orientation=RegExp.$5,a.url.bucket=(e=RegExp.$6,/^[a-z\d]+(\-[a-z\d]+)*$/i.test(e)?e.toLowerCase():""),a.url.base=decodeURI($m.__href).replace(/\/[^\/]*$/,"/"),a.url.external=Boolean(/^https?:\/\//i.test(a.url.query)),a.url.src="apps.html"+(a.url.bucket?"?"+a.url.bucket:""),a.url.external?a.url.src=a.url.query:/^([\w-\.:]+)(?:\/([\w-\.:]*))?$/.test(a.url.query)&&(a.url.index=RegExp.$2||"index",a.url.app=RegExp.$1.replace(/\:/g,"/"),a.url.ext="html",a.url.src="frontend/apps/"+a.url.app+"/"+a.url.index+"."+a.url.ext)),a}},DigitalSandboxWrap.prototype={_html:function(){var t,e;e=['<div class="modal fade" id="'+(t="DigitalSandboxModalAbout")+'" tabindex="-1" role="dialog" aria-labelledby="'+t+'Label" aria-hidden="true">','<div class="modal-dialog modal-dialog-centered" role="document">','<div class="modal-content">','<div class="modal-header">','<h5 class="modal-title" id="'+t+'Label">','<span class="text-muted"><i class="fas fa-info-circle"></i></span>',"</h5>",'<button type="button" class="close" data-dismiss="modal" aria-label="Close">','<span aria-hidden="true">&times;</span>',"</button>","</div>",'<div class="modal-body text-center py-5">',"<p><strong>"+$m.master.ver.product+'</strong> <span class="text-muted">v'+$m.master.ver.number+"</span></p>",'<img src="frontend/img/brand/launcher-icon-4x.png" alt="Logo">',"</div>",'<div class="modal-footer text-right">','<small class="text-muted">'+$m.master.ver.str+"</small>",'<small class="text-muted"><a href="https://github.com/codeworksdev/digital-sandbox"> `<img border="0" alt="GitHub" src="https://github.com/favicon.ico" width="20" height="20"> </a></small>',"</div>","</div>","</div>","</div>"],$m.__body.append(e.join(""))},_toolbar:function(){$m.extend("toolbar",DigitalSandboxToolbar,function(){this.onload()})},_init:function(){if($m.master.url.device){var t='[data-button="'+$m.master.url.device+'"]',e=$m.device.inner.find(t);$m.device.select(e.get(0))}$m.master.url.orientation&&$m.device.rotate($m.master.url.orientation),$m.master.iframe.attr("src",$m.master.url.src)}},DigitalSandboxToolbar.prototype={_options:function(){this.options={buttons:[{slug:"home",icon:"fas fa-home",label:"Home"},{slug:"refresh",icon:"fas fa-sync-alt",label:"Refresh Parent Window"},{slug:"qrefresh",icon:"fas fa-redo-alt",label:"Refresh Framed Window"},{slug:"reload",icon:"fas fa-bolt",label:"Reload Frame"},{slug:"device",icon:"fas fa-desktop",label:"Device Mode"},{slug:"rotate",icon:"fas fa-arrows-alt-v",label:"Orientation"},{slug:"wallpaper",icon:"fas fa-image",label:"Wallpaper"},{slug:"launch",icon:"fas fa-th-list",label:"Launcher"},{slug:"about",icon:"fas fa-info-circle",label:"About"},{slug:"collapse",icon:"far fa-times-circle",label:"Collapse"},{slug:"expand",icon:"fas fa-angle-left",label:"Expand"}],walls:["default","desk","landscape","bulbs"]}},_html:function(){$m.__container.prepend('<div id="toolbar"><div id="inner-toolbar"></div></div>'),_.each(this.options.buttons,function(t){var e=$("#inner-toolbar"),a='<div data-button="'+t.slug+'" title="'+t.label+'"><i class="fa-fw '+t.icon+'"></i></div>';e.append(a)})},_vars:function(){this.container=$("#toolbar"),this.inner=$("#inner-toolbar"),this.buttons=this.inner.find("[data-button]")},do:function(t){var e=_.isElement(t)?$(t):t,a=e.attr("data-button");return this["do"+window.s.capitalize(a)](e),this},doAbout:function(t){$("#DigitalSandboxModalAbout").modal()},doCollapse:function(t){this.container.attr("data-collapsed","yes")},doDevice:function(t){$m.device.open(t)},doExpand:function(t){this.container.removeAttr("data-collapsed")},doHome:function(t){window.location.href=$m.master.url.dir},doLaunch:function(t){var e=window.location.href.replace($m.master.regex,"$1?|$6");window.location.href=/\|.+$/.test(e)?e:e.replace(/\?\|$/,"")},doQrefresh:function(t){try{$m.master.iframe[0].contentWindow.location.reload()}catch(t){this.doRefresh()}},doRefresh:function(t){window.location.reload(!0)},doReload:function(t){$m.master.iframe.attr("src",$m.master.iframe.attr("src"))},doRotate:function(t){$m.device.rotate()},doWallpaper:function(t){$m.toolbar.toggleWallpaper()},onload:function(){return _.each(this.options.buttons,function(t){switch(t.slug){case"device":$m.extend(t.slug,DigitalSandboxDevice,function(){this.onload()})}}),$m.onClick(this.buttons,function(){$m.toolbar.do(this)}),this},toggleWallpaper:function(){var t=$m.__body.attr("data-wall")||"default",e=_.indexOf(this.options.walls,t);return new_w_index=e+1,new_w=this.options.walls[new_w_index<this.options.walls.length?new_w_index:0],$m.__body.attr("data-wall",new_w),this}},DigitalSandboxDevice.prototype={_options:function(){this.options={buttons:{default:"Default",fullscreen:"Full Screen",ipad:"iPad",ipad_mini:"iPad Mini",ipad_air:"iPad Air",ipad_pro_9_7:"iPad Pro 9.7-inch",ipad_pro_12_9:"iPad Pro 12.9-inch",iphone_5s:"iPhone 5",iphone_6plus:"iPhone 6 Plus",galaxy_s5:"Galaxy S5",nexus_7:"Nexus 7",nexus_10:"Nexus 10"},container_id:"device-menu"}},_html:function(){$m.toolbar.buttons.filter('[data-button="device"]').append('<div id="'+this.options.container_id+'"><div id="inner-'+this.options.container_id+'"><span data-action="exit"><i class="fas fa-times-circle"></i></span></div></div>')},_vars:function(){this.def=$m.__body.attr("data-device"),this.container=$("#"+this.options.container_id),this.inner=$("#inner-"+this.options.container_id)},action:function(t){var e=_.isElement(t)?$(t):t;return this["action__"+e.attr("data-action")](e),this},action__exit:function(t){return setTimeout("$m.device.close()",50),this},close:function(){return this.container.removeClass("open"),this},onload:function(){return _.each(this.options.buttons,function(t,e){this.inner.append('<span data-button="'+e+'"><span>'+t+"</span></span>"),e==this.def&&this.inner.find('[data-button="'+e+'"]').addClass("selected")},this),$m.onClick(this.inner.find("[data-button]"),function(){$m.device.select(this)}),$m.onClick(this.inner.find("[data-action]"),function(){$m.device.action(this)}),this},open:function(){return this.container.hasClass("open")||this.container.addClass("open"),this},rotate:function(t){var e,a,i="data-orientation";return a=/^[lp]$/.test(t)?t:(e=$m.__body.attr(i))&&"l"==e?"p":"l",$m.__body.attr(i,a),this},select:function(t){var e=_.isElement(t)?$(t):t,a=e.attr("data-button"),i="selected";return e.hasClass(i)||(this.inner.find('[data-button="'+a+'"]').addClass(i),this.inner.find(':not([data-button="'+a+'"])').removeClass(i),$m.__body.attr("data-device",a)),this}},DigitalSandboxApps.prototype={_vars:function(t){this.bucket=/\?([a-z\d]+(\-[a-z\d]+)*)$/.test(decodeURI($m.__href))?RegExp.$1:"",this.container=$m.__container.find("#apps"),this.widgetName=this.container.attr("data-widget"),this.cols=this.container.find('[class^="col-"]')},_init:function(){this.cols.length&&(this.widgetName&&/^[a-z][a-z\d]*$/.test(this.widgetName)||this.container.attr("data-widget",this.widgetName="simple"),this["__widget_"+this.widgetName]&&_.each(this.cols,function(t,e){var a={};a.col=$(t),a.groups=a.col.find("div[data-title]"),a.length=a.groups.length,a.length&&(a.classNames=["ds-widget","ds-widget-"+this.widgetName],a.id=a.classNames[1]+"-"+e,a.col.html('<div class="'+a.classNames.join(" ")+'" id="'+a.id+'">'+this["__widget_"+this.widgetName](a)+"</div>"))},this)),$m.__body.attr("data-ready","yes")},__widget_accordion:function(t){var e=0,a=[];do{a.push(function(t,e,a,i){for(var n,o,s,l=0,r=e.length,d=[];l<r;)o=(n=e.eq(l++)).attr("data-title"),s=$m.sanitizeTitle(o),t.bucket&&s!=t.bucket||d.push('<div class="card bg-light" data-bucket="'+s+'"><div class="card-header" id="'+a+"-heading"+i+'"><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#'+a+"-collapse"+i+'" aria-expanded="false" aria-controls="'+a+"-collapse"+i+'">'+o+'</button></h5></div><div id="'+a+"-collapse"+i+'" class="collapse" aria-labelledby="'+a+"-heading"+i+'" data-parent="#'+a+'"><div class="card-body">'+t.getHTML_table(n)+"</div></div></div>");return d.join("")}(this,t.groups.eq(e),t.id,e))}while(++e<t.length);return a.join("")},__widget_simple:function(t){var e=0,a=[];do{a.push(function(t,e,a,i){for(var n,o,s,l=0,r=e.length,d=[];l<r;)o=(n=e.eq(l++)).attr("data-title"),s=$m.sanitizeTitle(o),t.bucket&&s!=t.bucket||d.push('<div data-bucket="'+s+'"><h1>'+o+"</h1>"+t.getHTML_table(n)+"</div>");return d.join("")}(this,t.groups.eq(e),t.id))}while(++e<t.length);return a.join("")},getHTML_table:function(t,e){var a=arguments.length>1?e:"table-sm table-bordered table-hover";return'<table class="table'+(/\w/.test(a)?" "+a:"")+'"><tbody>'+_.map(t.find("a[href]"),function(t){var e,a,i,n=$(t),o=(e=n.attr("href"),a=this,i={internal:null,external:null},/^\.\/\?(.+)$/.test(e)?(i.internal="./index.html?"+RegExp.$1,i.meta=$m.master.getMeta(i.internal).url,i.external=_.size(i.meta)?/^https?:\/{2}/i.test(i.meta.src)?i.meta.src:i.meta.base+i.meta.src:null,a.bucket&&!/\|.*$/.test(i.internal)&&(i.internal+="|"+a.bucket)):i.external=e,i);return"<tr>"+["<td>",'<a target="'+(o.internal?"_top":"_blank")+'" title="'+n.text()+'" href="'+(o.internal||o.external)+'">',n.html(),"</a>","</td>",'<td title="Launch Internal">',o.internal?'<a target="_top" href="'+o.internal+'">':'<span class="text-muted">','<i class="fas fa-sign-in-alt"></i>',o.internal?"</a>":"</span>","</td>",'<td title="Launch External">',o.external?'<a target="_blank" href="'+o.external+'">':'<span class="text-muted">','<i class="fas fa-link"></i>',o.external?"</a>":"</span>","</td>"].join("")+"</tr>"},this).join("")+"</tbody></table>"}};
