/*!
 * Digital Sandbox v1.3.1 (https://github.com/codeworksdev/digital-sandbox)
 * Copyright (c) 2016 CODEWORKS <guru@codeworksnyc.com>
 * Licensed under the MIT license
 */
function DigitalSandboxWrapper(){this._vars(),this._toolbar(),this._init()}function DigitalSandboxApps(){this._vars()}function DigitalSandboxToolbar(){this._vars(),this._html()}function DigitalSandboxDevice(){this._vars(),this._html()}Mochi_init=function(t){},$(document).ready(function(t){switch(Number($m.getView())){case 0:$m.extend("wrapper",DigitalSandboxWrapper);break;case 1:$m.extend("apps",DigitalSandboxApps,function(){this.onload()})}}),DigitalSandboxWrapper.prototype={_vars:function(){if(this.ver={date:"2016-08-17",number:"1.3.1",product:"Digital Sandbox",type:"final"},this.ver.str=this.ver.product+" v"+this.ver.number+"-"+this.ver.date.replace(/\D/g,"")+"-"+this.ver.type,this.href=window.location.href,this.url={},this.iframe=$("#inner-content > iframe"),/^([^\?]+)(?:\?([^\?]*))?$/.test(this.href))switch(this.url.dir=RegExp.$1,this.url.query=RegExp.$2,this.url.type=/^https?:\/\//i.test(this.url.query)?"ext":"int",this.url.src="./apps.html",this.url.type){case"ext":this.url.src=this.url.query;break;case"int":/^([\w-:]+)(?:\/([\w-:]*))?$/.test(this.url.query)&&(this.url.index=RegExp.$2||"index",this.url.app=RegExp.$1.replace(/\:/g,"/"),this.url.ext="html",this.url.src="./frontend/apps/"+this.url.app+"/"+this.url.index+"."+this.url.ext)}},_toolbar:function(){$m.extend("toolbar",DigitalSandboxToolbar,function(){this.onload()})},_init:function(){this.iframe.attr("src",this.url.src)}},DigitalSandboxApps.prototype={_vars:function(){this.container=$m.content.find("#apps"),this.cols=this.container.find('.row > [class^="col-"][data-widgetize="yes"]'),this.widget=this.container.attr("data-widget")},onload:function(){this.cols.each(function(t){$m.apps.widget&&/^\w+$/.test($m.apps.widget)&&$m.apps["widget_"+$m.apps.widget](this,t)})},widget_accordion:function(t,i){for(var e,t=$(t),a="accordion"+i,n=['<div class="panel-group" id="'+a+'" role="tablist" aria-multiselectable="true">',"</div>"],o=t.find("ul[title]"),r=[],i=0;e=o[i++];)r.push(this.widget_accordion_group2html(e,a,i));t.html(n[0]+r.join("")+n[1])},widget_accordion_group2html:function(t,i,e){for(var a,n=$(t),o=0,r=n.length,s=[];r>o;)a={},a.container=$(n[o++]),a.title=a.container.attr("title"),a.apps=a.container.find("a[href]"),a.n=e,s.push('<div class="panel panel-default"><div class="panel-heading" role="tab" id="'+i+"-heading"+a.n+'"><h4 class="panel-title"><a class="collapsed" role="button" data-toggle="collapse" data-parent="#'+i+'" href="#'+i+"-collapse"+a.n+'" aria-expanded="false" aria-controls="'+i+"-collapse"+a.n+'">'+a.title+'</a></h4></div><div id="'+i+"-collapse"+a.n+'" class="panel-collapse collapse" role="tabpanel" aria-labelledby="'+i+"-heading"+a.n+'"><div class="panel-body"><table class="table table-striped table-condensed"><tbody>'),_.each(a.apps,function(t){t=$(t),s.push('<tr><td><a target="'+(t.attr("target")?t.attr("target"):"_top")+'" title="'+t.text()+'" href="'+t.attr("href")+'">'+t.html()+'</a></td><td class="text-right"><a target="_top" title="Launch" href="'+t.attr("href")+'"><i class="fa fa-fw fa-external-link"></i></a></td></tr>')}),s.push("</tbody></table></div></div></div>");return s.join("")}},DigitalSandboxToolbar.prototype={_vars:function(){this.options={buttons:{refresh:"Refresh Window",qrefresh:"Quick Refresh",reload:"Refresh App",device:"Device Mode",rotate:"Orientation",launch:"Index",about:"About"}}},_html:function(){$m.container.prepend('<div id="toolbar">  <div id="inner-toolbar"></div></div>')},onload:function(){_.each(this.options.buttons,function(t,i){switch($("#inner-toolbar").append('<span data-button="'+i+'" title="'+t+'"></span>'),i){case"device":$m.extend(i,DigitalSandboxDevice,function(){this.onload()})}}),$m.onClick($("#inner-toolbar").find("> [data-button]"),function(){$m.toolbar.select(this)})},select:function(t){var i=_.isElement(t)?$(t):t,e=i.attr("data-button"),a="do"+window.s.capitalize(e);this[a](i)},doRefresh:function(t){window.location.reload(!0)},doReload:function(t){$m.wrapper.iframe.attr("src",$m.wrapper.iframe.attr("src"))},doQrefresh:function(t){try{$m.wrapper.iframe[0].contentWindow.location.reload()}catch(i){alert("This feature is not available in offline mode.")}},doLaunch:function(t){window.location.href=window.location.href.replace(/^([^\?]+)(\?.*)?$/,"$1"),$m.wrapper.iframe.attr("src","./apps.html")},doDevice:function(t){$m.device.open(t)},doRotate:function(t){$m.device.rotate()},doAbout:function(t){alert($m.wrapper.ver.str)}},DigitalSandboxDevice.prototype={_vars:function(){this.options={buttons:{"default":"Default",fullscreen:"Full Screen",ipad:"iPad",ipad_air:"iPad Air",ipad_mini:"iPad Mini",ipad_pro_9_7:"iPad Pro 9.7-inch",ipad_pro_12_9:"iPad Pro 12.9-inch",iphone_5s:"iPhone 5",iphone_6plus:"iPhone 6 Plus",galaxy_s5:"Galaxy S5",nexus_7:"Nexus 7",nexus_10:"Nexus 10"},container_id:"device-menu"}},_html:function(){this.container=$('#inner-toolbar [data-button="device"]').append('<div id="'+this.options.container_id+'">  <div id="inner-'+this.options.container_id+'">    <span data-action="exit"></span>  </div></div>').find("#"+this.options.container_id)},onload:function(){_.each(this.options.buttons,function(t,i){var e="inner-"+$m.device.options.container_id;switch($("#"+e).append('<span data-button="'+i+'"><span>'+t+"</span></span>"),i){case"default":$("#"+e+' [data-button="'+i+'"]').addClass("selected")}}),$m.onClick($("#inner-"+this.options.container_id).find("[data-button]"),function(){$m.device.select(this)}),$m.onClick($("#inner-"+this.options.container_id).find("[data-action]"),function(){$m.device.action(this)})},select:function(t){var i=_.isElement(t)?$(t):t,e=i.attr("data-button"),a=i.hasClass("selected");a||($("#inner-"+this.options.container_id+' [data-button="'+e+'"]').addClass("selected"),$("#inner-"+this.options.container_id+' :not([data-button="'+e+'"])').removeClass("selected"),$m.body.attr("data-device",e))},action:function(t){var i=_.isElement(t)?$(t):t,e=i.attr("data-action"),a=e;this[a]()},rotate:function(){var t="data-orientation",i=$m.body.attr(t),e=i&&"l"==i?"p":"l";$m.body.attr(t,e)},open:function(){this.container.hasClass("open")||this.container.addClass("open")},close:function(){this.container.removeClass("open")},exit:function(){setTimeout(function(){$m.device.close()},50)}};
