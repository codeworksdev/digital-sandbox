/*!
 * Digital Sandbox v2.1 (https://github.com/codeworksdev/digital-sandbox)
 * Copyright (c) 2014-2018 CODEWORKS <support@codeworksnyc.com>
 * Licensed under the MIT license
 */
function mochi_init(){'index'==this.__page_name&&/^https:\/\//.test(this.__href)&&this.setOption('ENABLE_SERVICE_WORKER',!1)}function mochi_load_page0(){this.extend('clipboard',MyClipboard),this.extend('master',DigitalSandboxMaster),window.self==window.top?this.extend('wrap',DigitalSandboxWrap):this.extend('apps',DigitalSandboxApps)}function MyClipboard(){}MyClipboard.prototype={_copyFallback:function(j){var m=document.createElement('textarea');m.value=j,document.body.appendChild(m),m.focus(),m.select();try{document.execCommand('copy'),this.onSuccess()}catch(p){this.onError(p)}document.body.removeChild(m)},copy:function(j){navigator.clipboard?navigator.clipboard.writeText(j).then(function(){$m.clipboard.onSuccess()},function(m){$m.clipboard.onError(m)}):this._copyFallback(j)},onError:function(j){alert(j)},onSuccess:function(){}};function DigitalSandboxMaster(){this._options(),this._html(),this._vars()}DigitalSandboxMaster.prototype={_options:function(){this.options=JSON.parse(JSON.stringify(_.defaults(DigitalSandboxOptions,{BODY:'',BROWSER_TAB_AUTO_LABEL:!0,BROWSER_TAB_SUFFIX:'Digital Sandbox',BROWSER_TAB_SUFFIX_DELIMITER:'|',BROWSER_TAB_SUFFIX_ENABLED:!0,LAUNCHER_AUTOGEN_TITLE_VARS:!0,LAUNCHER_ENABLE_TITLE_VAR:!0,LAUNCHER_HTML_HEADER_BODY:'',LAUNCHER_HTML_HEADER_ENABLED:!0,LAUNCHER_HTML_HEADER_H1:'Digital Sandbox',LAUNCHER_HTML_HEADER_H2:'Please make a selection to begin.',LAUNCHER_WIDGET_NAME:'simple',THEME_DEFAULT_DEVICE:'ipad',THEME_DEFAULT_ORIENTATION:'l',THEME_DEFAULT_WALLPAPER_NAME:'desk',TOOLBAR_ENABLE_ABOUT:!0,TOOLBAR_ENABLE_COLLAPSE:!0,TOOLBAR_ENABLE_DEVICE:!0,TOOLBAR_ENABLE_EXPAND:!0,TOOLBAR_ENABLE_HOME:!0,TOOLBAR_ENABLE_LAUNCH:!0,TOOLBAR_ENABLE_QREFRESH:!0,TOOLBAR_ENABLE_REFRESH:!0,TOOLBAR_ENABLE_RELOAD:!0,TOOLBAR_ENABLE_ROTATE:!0,TOOLBAR_ENABLE_WALLPAPER:!0,TOOLBAR_ENABLED:!0,TOOLBAR_START_COLLAPSED:!1})))},_html:function(){var j=function(m){$m.__body.prepend(m.join('')),$m.__container=$m.__body.find('#container')};window.self==window.top?j(['<div id="container">','<table>','<tbody>','<tr>','<td class="align-middle">','<div id="content">','<iframe src="about:blank"></iframe>','</div>','</td>','</tr>','</tbody>','</table>','</div>']):(j(['<div id="container" class="container my-4">','<div class="row">','<div class="col-xl">','<div id="header" class="d-none">','<h1 class="display-4"></h1>','<p class="lead"></p>','<hr>','</div>','<div id="apps"></div>','</div>','</div>','</div>']),$m.setView(1))},_vars:function(){this.ver={date:'2018-08-31',number:'2.1',product:'Digital Sandbox',type:'final'},this.ver.str='<strong>v'+this.ver.number+'-'+this.ver.type+'</strong> '+this.ver.date,this.regex=/^([^\?]+)(?:\?([^\?~\|&]*))?(?:~(([a-z]\w*)(?::([lp]))?))?(?:\|([a-z\d\-]*))?(?:&title=(.*))?$/i,this.iframe=$('iframe'),this.href=decodeURI($m.__href),this.url=this.getMeta(this.href).url},getMeta:function(j){var m={url:{}},p=decodeURI(j||$m.__href);return this.regex.test(p)&&(m.url.dir=RegExp.$1,m.url.query=RegExp.$2,m.url.device=RegExp.$4,m.url.orientation=RegExp.$5,m.url.title=RegExp.$7,m.url.bucket=function(q){return /^[a-z\d]+(\-[a-z\d]+)*$/i.test(q)?q.toLowerCase():''}(RegExp.$6),m.url.base=decodeURI($m.__href).replace(/\/[^\/]*$/,'/'),m.url.external=!!/^https?:\/\//i.test(m.url.query),m.url.src='index.html'+(m.url.bucket?'?'+m.url.bucket:''),m.url.external?m.url.src=m.url.query:/^([\w-\.:]+)(?:\/([\w-\.:]*))?$/.test(m.url.query)&&(m.url.index=RegExp.$2||'index',m.url.app=RegExp.$1.replace(/\:/g,'/'),m.url.ext='html',m.url.src='frontend/apps/'+m.url.app+'/'+m.url.index+'.'+m.url.ext)),m}};function DigitalSandboxWrap(){this._html(),this._toolbar(),this._init()}DigitalSandboxWrap.prototype={_html:function(){$m.master.options.LAUNCHER_ENABLE_TITLE_VAR&&function(j){var m=null;if(_.has(j,'title')&&/\S/.test(j.title))m=j.title;else if(!_.has(j,'app'))/^https?:\/\/([^\/]+)/i.test(j.src)&&$m.master.options.BROWSER_TAB_AUTO_LABEL&&(m=RegExp.$1.toLowerCase());else if($m.master.options.BROWSER_TAB_AUTO_LABEL){var p=/([^\/]+)$/.exec(j.app)[1],q=function(w){return $.trim(window.s.capitalize(w,!0))};/\S/.test(m=_.compact(_.map(p.split(/[^a-z\d]/i),q)).join(' '))&&(m=m.replace(/(\d)\s+(\d)/g,'$1.$2'),m=m.toUpperCase(),m=m.replace(/\sV(\d+)/,' v$1'))}null!==m&&/\S/.test(m)&&($m.master.options.BROWSER_TAB_SUFFIX_ENABLED&&(m+=' '+$.trim($m.master.options.BROWSER_TAB_SUFFIX_DELIMITER||'|')+' ',m+=/\S/.test($m.master.options.BROWSER_TAB_SUFFIX)?$m.master.options.BROWSER_TAB_SUFFIX:$m.master.ver.product),$m.__html.find('title').text(m))}($m.master.url),/^\w+$/.test($m.master.options.THEME_DEFAULT_DEVICE)&&$m.__body.attr('data-device',$m.master.options.THEME_DEFAULT_DEVICE),/^\w+$/.test($m.master.options.THEME_DEFAULT_ORIENTATION)&&$m.__body.attr('data-orientation',$m.master.options.THEME_DEFAULT_ORIENTATION),/^\w+$/.test($m.master.options.THEME_DEFAULT_WALLPAPER_NAME)&&$m.__body.attr('data-wall',$m.master.options.THEME_DEFAULT_WALLPAPER_NAME),function(){var j='DigitalSandboxModalAbout',m=['<div class="modal fade" id="'+j+'" tabindex="-1" role="dialog" aria-labelledby="'+j+'Label" aria-hidden="true">','<div class="modal-dialog modal-dialog-centered" role="document">','<div class="modal-content">','<div class="modal-header">','<h5 class="modal-title" id="'+j+'Label">','<span><strong>'+$m.master.ver.product+' <span class="text-muted">v'+$m.master.ver.number+'</span></strong></span>','</h5>','<button type="button" class="close" data-dismiss="modal" aria-label="Close">','<span aria-hidden="true">&times;</span>','</button>','</div>','<div class="modal-body text-center py-5">','<img src="frontend/img/brand/launcher-icon-4x.png" alt="Logo">','</div>','<div class="modal-footer text-right">','<small class="text-muted">'+$m.master.ver.str+'</small>','<a target="_blank" href="https://github.com/codeworksdev/digital-sandbox" title="GitHub">','<span class="text-info"><i class="fab fa-lg fa-github"></i></span>','</a>','</div>','</div>','</div>','</div>'];$m.__body.append(m.join(''))}()},_toolbar:function(){$m.extend('toolbar',DigitalSandboxToolbar,function(){this.onload()})},_init:function(){if($m.master.url.device){var j='[data-button="'+$m.master.url.device+'"]',m=$m.device.inner.find(j);$m.device.select(m.get(0))}$m.master.url.orientation&&$m.device.rotate($m.master.url.orientation),$m.master.iframe.attr('src',$m.master.url.src)}};function DigitalSandboxToolbar(){this._options(),this._html(),this._vars()}DigitalSandboxToolbar.prototype={_options:function(){this.options={buttons:[{slug:'home',icon:'fas fa-home',label:'Home'},{slug:'refresh',icon:'fas fa-sync-alt',label:'Refresh Parent Window'},{slug:'qrefresh',icon:'fas fa-redo-alt',label:'Refresh Framed Window'},{slug:'reload',icon:'fas fa-bolt',label:'Reload Frame'},{slug:'device',icon:'fas fa-desktop',label:'Device Mode'},{slug:'rotate',icon:'fas fa-arrows-alt-v',label:'Orientation'},{slug:'wallpaper',icon:'fas fa-image',label:'Wallpaper'},{slug:'launch',icon:'fas fa-th-list',label:'Launcher'},{slug:'about',icon:'fas fa-info-circle',label:'About'},{slug:'collapse',icon:'far fa-times-circle',label:'Collapse'},{slug:'expand',icon:'fas fa-angle-left',label:'Expand'}],walls:['default','desk','landscape','bulbs']}},_html:function(){var j=['<div id="toolbar">','<div id="inner-toolbar"></div>','</div>'];$m.master.options.TOOLBAR_ENABLED||(j[0]=j[0].replace(/>$/,' class="d-none">')),$m.master.options.TOOLBAR_START_COLLAPSED&&(j[0]=j[0].replace(/>$/,' data-collapsed="yes">')),$m.__container.prepend(j.join('')),_.each(this.options.buttons,function(m){var p=$('#inner-toolbar'),q=!!$m.master.options['TOOLBAR_ENABLE_'+m.slug.toUpperCase()],w=['<div data-button="'+m.slug+'" title="'+m.label+'">','<i class="fa-fw '+m.icon+'"></i>','</div>'];switch(m.slug){case'expand':q=!!$m.master.options.TOOLBAR_ENABLE_COLLAPSE;}q||(w[0]=w[0].replace(/>$/,' class="d-none">')),p.append(w.join(''))})},_vars:function(){this.container=$('#toolbar'),this.inner=$('#inner-toolbar'),this.buttons=this.inner.find('[data-button]')},do:function(j){var m=_.isElement(j)?$(j):j,p=m.attr('data-button'),q='do'+window.s.capitalize(p);return this[q](m),this},doAbout:function(){$('#DigitalSandboxModalAbout').modal()},doCollapse:function(){this.container.attr('data-collapsed','yes')},doDevice:function(j){$m.device.open(j)},doExpand:function(){this.container.removeAttr('data-collapsed')},doHome:function(){window.location.href=$m.master.url.dir},doLaunch:function(){var m=window.location.href.replace($m.master.regex,'$1?|$6');window.location.href=/\|.+$/.test(m)?m:m.replace(/\?\|$/,'')},doQrefresh:function(){try{$m.master.iframe[0].contentWindow.location.reload()}catch(m){this.doRefresh()}},doRefresh:function(){window.location.reload(!0)},doReload:function(){$m.master.iframe.attr('src',$m.master.iframe.attr('src'))},doRotate:function(){$m.device.rotate()},doWallpaper:function(){$m.toolbar.toggleWallpaper()},onload:function(){return _.each(this.options.buttons,function(j){switch(j.slug){case'device':$m.extend(j.slug,DigitalSandboxDevice,function(){this.onload()});}}),$m.onClick(this.buttons,function(){$m.toolbar.do(this)}),this},toggleWallpaper:function(){var j=$m.__body.attr('data-wall')||'default',m=_.indexOf(this.options.walls,j);return new_w_index=m+1,new_w=this.options.walls[new_w_index<this.options.walls.length?new_w_index:0],$m.__body.attr('data-wall',new_w),this}};function DigitalSandboxDevice(){this._options(),this._html(),this._vars()}DigitalSandboxDevice.prototype={_options:function(){this.options={buttons:{default:'Default',fullscreen:'Full Screen',ipad:'iPad',ipad_mini:'iPad Mini',ipad_air:'iPad Air',ipad_pro_9_7:'iPad Pro 9.7-inch',ipad_pro_12_9:'iPad Pro 12.9-inch',iphone_5s:'iPhone 5',iphone_6plus:'iPhone 6 Plus',galaxy_s5:'Galaxy S5',nexus_7:'Nexus 7',nexus_10:'Nexus 10'},container_id:'device-menu'}},_html:function(){$m.toolbar.buttons.filter('[data-button="device"]').append('<div id="'+this.options.container_id+'"><div id="inner-'+this.options.container_id+'"><span data-action="exit"><i class="fas fa-times-circle"></i></span></div></div>')},_vars:function(){this.def=$m.__body.attr('data-device'),this.container=$('#'+this.options.container_id),this.inner=$('#inner-'+this.options.container_id)},action:function(j){var m=_.isElement(j)?$(j):j,p='action__'+m.attr('data-action');return this[p](m),this},action__exit:function(){return setTimeout('$m.device.close()',50),this},close:function(){return this.container.removeClass('open'),this},onload:function(){return _.each(this.options.buttons,function(j,m){this.inner.append(['<span data-button="'+m+'">','<span title="'+j+'">'+j+'</span>','<span class="float-right">','<span data-option="launch-internal" title="Launch Internal"><i class="fas fa-fw fa-sign-in-alt"></i></span>','<span data-option="launch-external" title="Launch External"><i class="fas fa-fw fa-link"></i></span>','<span data-option="copy-url">','<span data-toggle="popover" data-content="Copied!"><i title="Copy URL" class="far fa-copy"></i></span>','</span>','</span>','</span>'].join('')),m==this.def&&this.inner.find('[data-button="'+m+'"]').addClass('selected')},this),$m.onClick(this.inner.find('[data-action]'),function(){$m.device.action(this)}),$m.onClick(this.inner.find('[data-button] > span:nth-child(1)'),function(){$m.device.select($(this).parent())}),$m.onClick(this.inner.find('[data-button] > span:last-child > span'),{getURLbyDeviceName:function(j){var m=$m.__href,p=null;return p=/\~[a-z][a-z\d_]*/.test(m)?m.replace(/\~[a-z][a-z\d_]*/,'~'+j):/\S/.test($m.master.url.query)?m.replace($m.master.url.query,$m.master.url.query+'~'+j):m+'?~'+j,p}},function(j){var m=$(this),p=m.parents('[data-button]:eq(0)'),q=p.attr('data-button'),w=m.attr('data-option');'copy-url'===w?($m.clipboard.copy(j.data.getURLbyDeviceName(q)),setTimeout(function(){$('.popover[role="tooltip"]').popover('hide')},1500)):'launch-external'===w?window.location.assign(j.data.getURLbyDeviceName(q)):'launch-internal'===w?p.find('> span:nth-child(1)').trigger($m.getOnClickName()):void 0}),$('[data-toggle="popover"]').popover({placement:'left'}),this},open:function(){return this.container.hasClass('open')||this.container.addClass('open'),this},rotate:function(j){var p,q,m='data-orientation';return /^[lp]$/.test(j)?q=j:(p=$m.__body.attr(m),q=p?'l'==p?'p':'l':'l'),$m.__body.attr(m,q),this},select:function(j){var m=_.isElement(j)?$(j):j,p=m.attr('data-button'),q='selected',w=m.hasClass(q);return w||(this.inner.find('[data-button="'+p+'"]').addClass(q),this.inner.find(':not([data-button="'+p+'"])').removeClass(q),$m.__body.attr('data-device',p)),this}};function DigitalSandboxApps(){this._vars(),this._html(),this._init()}DigitalSandboxApps.prototype={_vars:function(){this.bucket=/\?([a-z\d]+(\-[a-z\d]+)*)$/.test(decodeURI($m.__href))?RegExp.$1:'',this.header=$m.__container.find('#header'),this.container=$m.__container.find('#apps'),this.widgetName=this.container.attr('data-widget'),this.cols=this.container.find('[class^="col-"]')},_html:function(){$m.master.options.LAUNCHER_WIDGET_NAME&&/^\w+$/.test($m.master.options.LAUNCHER_WIDGET_NAME)&&(this.container.attr('data-widget',$m.master.options.LAUNCHER_WIDGET_NAME),this.widgetName=$m.master.options.LAUNCHER_WIDGET_NAME),$m.master.options.LAUNCHER_HTML_HEADER_ENABLED&&($m.master.options.LAUNCHER_HTML_HEADER_H1&&/\S/.test($m.master.options.LAUNCHER_HTML_HEADER_H1)&&this.header.find('> h1').html($m.master.options.LAUNCHER_HTML_HEADER_H1),$m.master.options.LAUNCHER_HTML_HEADER_H2&&/\S/.test($m.master.options.LAUNCHER_HTML_HEADER_H2)&&this.header.find('> p.lead').html($m.master.options.LAUNCHER_HTML_HEADER_H2),this.header.removeClass('d-none')),_.has($m.master.options,'LAUNCHER_HTML_HEADER_BODY')&&$m.master.options.LAUNCHER_HTML_HEADER_BODY&&(this.header.find('> p.lead').after($m.master.options.LAUNCHER_HTML_HEADER_BODY),this.cols=this.container.find('[class^="col-"]')),_.has($m.master.options,'BODY')&&$m.master.options.BODY&&(this.container.empty().html($m.master.options.BODY),this.cols=this.container.find('[class^="col-"]'))},_init:function(){this.cols.length&&((!this.widgetName||!/^[a-z][a-z\d]*$/.test(this.widgetName))&&this.container.attr('data-widget',this.widgetName='simple'),this['__widget_'+this.widgetName]&&_.each(this.cols,function(j,m){var p={};p.col=$(j),p.groups=p.col.find('div[data-title]'),p.length=p.groups.length,p.length&&(p.classNames=['ds-widget','ds-widget-'+this.widgetName],p.id=p.classNames[1]+'-'+m,p.col.html('<div class="'+p.classNames.join(' ')+'" id="'+p.id+'">'+this['__widget_'+this.widgetName](p)+'</div>'))},this)),$m.__body.attr('data-ready','yes')},__widget_accordion:function(j){var m=0,p=[];do p.push(function(q,w,x,y){for(var C,D,E,z=0,A=w.length,B=[];z<A;)C=w.eq(z++),D=C.attr('data-title'),E=$m.sanitizeTitle(D),q.bucket&&E!=q.bucket||B.push('<div class="card bg-light" data-bucket="'+E+'"><div class="card-header" id="'+x+'-heading'+y+'"><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#'+x+'-collapse'+y+'" aria-expanded="false" aria-controls="'+x+'-collapse'+y+'">'+D+'</button></h5></div><div id="'+x+'-collapse'+y+'" class="collapse" aria-labelledby="'+x+'-heading'+y+'" data-parent="#'+x+'"><div class="card-body">'+q.getHTML_table(C)+'</div></div></div>');return B.join('')}(this,j.groups.eq(m),j.id,m));while(++m<j.length);return p.join('')},__widget_simple:function(j){var m=0,p=[];do p.push(function(q,w){for(var C,D,E,z=0,A=w.length,B=[];z<A;)C=w.eq(z++),D=C.attr('data-title'),E=$m.sanitizeTitle(D),q.bucket&&E!=q.bucket||B.push('<div data-bucket="'+E+'"><h1>'+D+'</h1>'+q.getHTML_table(C)+'</div>');return B.join('')}(this,j.groups.eq(m),j.id,m));while(++m<j.length);return p.join('')},getHTML_table:function(j,m){var p=1<arguments.length?m:'table-sm table-bordered table-hover',q='<table class="table'+(/\w/.test(p)?' '+p:'')+'"><tbody>',x=_.map(j.find('a[href]'),function(y){var z=$(y),A=$.trim(z.html().replace(/\s*<\w+[^>]*>([^<]*)<\/\w+>\s*/g,' ($1) ').replace(/\W\)/g,')')),B=this.getMetaByURL.call(this.instance,z.attr('href'),A),C=['<td>','<a target="'+(B.internal?'_top':'_blank')+'" title="'+z.text()+'" href="'+(B.internal||B.external)+'">',z.html(),'</a>','</td>','<td title="Launch Internal">',B.internal?'<a target="_top" href="'+B.internal+'">':'<span class="text-muted">','<i class="fas fa-sign-in-alt"></i>',B.internal?'</a>':'</span>','</td>','<td title="Launch External">',B.external?'<a target="_blank" href="'+B.external+'">':'<span class="text-muted">','<i class="fas fa-link"></i>',B.external?'</a>':'</span>','</td>'];return'<tr>'+C.join('')+'</tr>'},{instance:this,getMetaByURL:function(y,z){var A={external:null,internal:null,meta:null};return /^\.\/\?(.+)$/.test(y)?(A.internal='./index.html?'+RegExp.$1,$m.master.options.LAUNCHER_ENABLE_TITLE_VAR&&$m.master.options.LAUNCHER_AUTOGEN_TITLE_VARS&&!/&title=.*$/.test(A.internal)&&(A.internal+='&title='+encodeURIComponent(z)),A.meta=$m.master.getMeta(A.internal).url,A.external=_.size(A.meta)?/^https?:\/{2}/i.test(A.meta.src)?A.meta.src:A.meta.base+A.meta.src:null,this.bucket&&!/\|.*$/.test(A.internal)&&(A.internal+='|'+this.bucket)):A.external=y,A}});return q+x.join('')+'</tbody></table>'}};
